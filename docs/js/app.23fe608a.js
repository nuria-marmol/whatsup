(function(){"use strict";var e={4988:function(e,t,s){var o=s(9242),r=s(3396);const n={key:0},a=(0,r.Uk)("Home"),i={key:1},l=(0,r.Uk)("Buscar"),u=(0,r.Uk)("Login");function c(e,t,s,o,c,m){const d=(0,r.up)("router-view"),p=(0,r.up)("router-link"),h=(0,r.up)("custom-button");return(0,r.wg)(),(0,r.iD)("main",null,[(0,r.Wm)(d),(0,r._)("nav",null,[(0,r._)("ul",null,[e.$store.state.isLogin?((0,r.wg)(),(0,r.iD)("li",n,[(0,r.Wm)(p,{to:{name:"home"}},{default:(0,r.w5)((()=>[a])),_:1})])):(0,r.kq)("",!0),e.$store.state.isLogin?((0,r.wg)(),(0,r.iD)("li",i,[(0,r.Wm)(p,{to:{name:"search"}},{default:(0,r.w5)((()=>[l])),_:1})])):(0,r.kq)("",!0),(0,r._)("li",null,[e.$store.state.isLogin?((0,r.wg)(),(0,r.j4)(h,{key:0,text:"Salir",onDoClick:m.logout},null,8,["onDoClick"])):((0,r.wg)(),(0,r.j4)(p,{key:1,to:{name:"login"}},{default:(0,r.w5)((()=>[u])),_:1}))])])])])}var m=s(7139);const d=["type","disabled"];function p(e,t,s,n,a,i){return(0,r.wg)(),(0,r.iD)("div",null,[(0,r._)("button",{type:s.type,class:"button",onClick:t[0]||(t[0]=(0,o.iM)((t=>e.$emit("doClick")),["prevent"])),disabled:s.buttonDisabled},(0,m.zw)(s.text),9,d)])}var h={name:"CustomButton",emits:["doClick"],props:{type:{type:String,default:"button"},text:String,buttonDisabled:{type:Boolean,default:!1}}},g=s(89);const w=(0,g.Z)(h,[["render",p]]);var f=w,b=s(3506),_={data(){return{supabase:void 0}},mounted(){this.supabase=(0,b.eI)("https://bgztsnzrnjcijmheejnu.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJnenRzbnpybmpjaWptaGVlam51Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDU0MzgzNTEsImV4cCI6MTk2MTAxNDM1MX0.I9H5dgB3bE865BpMshHpsKR2_B3XFFtyEnR8mdvO_Lc")}},v={mixins:[_],methods:{checkLogin:async function(){"authenticated"!==await(this.supabase.auth.user()?.aud)&&this.$router.push({name:"login"})},isLogin:async function(){return"authenticated"!==await(this.supabase.auth.user()?.aud)}},mounted(){this.checkLogin()}},y={components:{customButton:f},mixins:[_,v],methods:{logout:async function(){await this.supabase.auth.signOut(),this.checkLogin(),this.$store.state.isLogin=!1}},mounted:async function(){this.$store.state.isLogin=await this.isLogin()}};const k=(0,g.Z)(y,[["render",c]]);var C=k,D=s(678);const E={class:"login"},x=(0,r._)("h1",null,"Identifícate",-1),V=(0,r.Uk)("¿Todavía no tienes cuenta? "),I=(0,r.Uk)("Regístrate"),j=(0,r.Uk)(".");function M(e,t,s,o,n,a){const i=(0,r.up)("CustomInput"),l=(0,r.up)("CustomButton"),u=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",E,[x,(0,r._)("form",null,[(0,r.Wm)(i,{label:"Email",placeholder:"Tu correo",type:"email",modelValue:n.email,"onUpdate:modelValue":t[0]||(t[0]=e=>n.email=e)},null,8,["modelValue"]),(0,r.Wm)(i,{label:"Contraseña",placeholder:"Tu contraseña",type:"password",modelValue:n.password,"onUpdate:modelValue":t[1]||(t[1]=e=>n.password=e)},null,8,["modelValue"]),(0,r.Wm)(l,{onDoClick:a.login,type:"submit",text:"Entrar"},null,8,["onDoClick"])]),(0,r._)("p",null,[V,(0,r.Wm)(u,{to:{name:"signup"}},{default:(0,r.w5)((()=>[I])),_:1}),j])])}const U={class:"input"},S={class:"input__label"},L=["type","placeholder","value"],B={key:0,class:"input__errors"};function N(e,t,s,o,n,a){return(0,r.wg)(),(0,r.iD)("div",U,[(0,r._)("label",S,[(0,r.Uk)((0,m.zw)(s.label),1),(0,r._)("input",{class:(0,m.C_)(["input__field",{input__error:s.showErrors}]),type:s.type,placeholder:s.placeholder,value:s.modelValue,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value))},null,42,L)]),s.showErrors?((0,r.wg)(),(0,r.iD)("ul",B,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.errorsList,((e,t)=>((0,r.wg)(),(0,r.iD)("li",{key:t},(0,m.zw)(e),1)))),128))])):(0,r.kq)("",!0)])}var Z={name:"CustomInput",props:{type:String,placeholder:String,label:String,showErrors:Boolean,errorsList:Array,modelValue:String}};const z=(0,g.Z)(Z,[["render",N],["__scopeId","data-v-c6cb9d32"]]);var W=z,O=s(530),P=s.n(O),$={name:"LoginView",mixins:[_],components:{CustomInput:W,CustomButton:f},data(){return{email:"",password:""}},methods:{login:async function(){P().start();const{user:e,session:t,error:s}=await this.supabase.auth.signIn({email:this.email,password:this.password});return null===e?alert(s.message):(this.$router.push({name:"home"}),this.$store.state.isLogin=!0),P().done(),t}},mounted(){this.$route.query.signup&&alert("Estás registrado")}};const T=(0,g.Z)($,[["render",M]]);var q=T;const A={class:"signup"},F=(0,r._)("h1",null,"Registro",-1),H={class:"signup__form"},R=(0,r.Uk)("Volver atrás");function J(e,t,s,o,n,a){const i=(0,r.up)("CustomInput"),l=(0,r.up)("customButton"),u=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",A,[F,(0,r._)("section",null,[(0,r._)("form",H,[(0,r.Wm)(i,{label:"Nombre",placeholder:"Tu nombre",type:"text",showErrors:n.nombreError,modelValue:n.nombre,"onUpdate:modelValue":t[0]||(t[0]=e=>n.nombre=e),errorsList:["El nombre debe tener más de 4 caracteres"]},null,8,["showErrors","modelValue"]),(0,r.Wm)(i,{label:"Correo",placeholder:"Tu correo",type:"email",showErrors:n.emailError,modelValue:n.email,"onUpdate:modelValue":t[1]||(t[1]=e=>n.email=e),errorsList:["No tiene un formato válido","Email obligatorio"]},null,8,["showErrors","modelValue"]),(0,r.Wm)(i,{label:"Contraseña",placeholder:"Tu contraseña",type:"password",showErrors:n.passwordError,modelValue:n.password,"onUpdate:modelValue":t[2]||(t[2]=e=>n.password=e),errorsList:["Necesitas una contraseña","Las contraseñas no coinciden"]},null,8,["showErrors","modelValue"]),(0,r.Wm)(i,{label:"Repite contraseña",type:"password",placeholder:"Repite tu contraseña",showErrors:n.passwordError,modelValue:n.password2,"onUpdate:modelValue":t[3]||(t[3]=e=>n.password2=e)},null,8,["showErrors","modelValue"]),(0,r.Wm)(l,{onDoClick:a.validar,type:"submit",text:"Registrarme"},null,8,["onDoClick"])])]),(0,r.Wm)(u,{to:{name:"login"}},{default:(0,r.w5)((()=>[R])),_:1})])}const Y=4;var X={name:"SignupView",mixins:[_],components:{CustomInput:W,CustomButton:f},data(){return{nombre:"",nombreError:!1,email:"",emailError:!1,password:"",password2:"",passwordError:!1}},methods:{validar:function(){console.log(this.nombre),this.nombreError=!1,this.emailError=!1,this.passwordError=!1,this.nombre.trim().length<Y&&(this.nombreError=!0),/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(this.email)||(this.emailError=!0),0!=this.password.trim().length&&this.password==this.password2||(this.passwordError=!0),this.nombreError||this.emailError||this.passwordError||this.createUser()},createUser:async function(){P().start();const{user:e,session:t,error:s}=await this.supabase.auth.signUp({email:this.email,password:this.password});return null===e?alert(s.message):(await this.supabase.from("social_network-profile").insert([{name:this.nombre,user_id:t.user.id}]),this.$router.push({name:"login",query:{signup:!0}})),P().done(),t}},mounted(){}};const K=(0,g.Z)(X,[["render",J]]);var G=K;const Q={class:"home container--padding"},ee=(0,r._)("h1",null,"Hola! c:",-1),te={class:"home__posts"};function se(e,t,s,o,n,a){const i=(0,r.up)("single-post"),l=(0,r.up)("custom-form"),u=(0,r.up)("customButton");return(0,r.wg)(),(0,r.iD)("div",Q,[ee,(0,r._)("div",te,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.posts,((e,t)=>((0,r.wg)(),(0,r.j4)(i,{key:t,message:e.text,userName:a.getUserName(e.user_id),date:a.getFormatDate(e.created_at),"is-my-post":a.isMyPost(e.user_id),id:e.id},null,8,["message","userName","date","is-my-post","id"])))),128))]),(0,r.Wm)(l,{"user-id":n.myId},null,8,["user-id"]),n.pag>1?((0,r.wg)(),(0,r.j4)(u,{key:0,onDoClick:t[0]||(t[0]=e=>n.pag=n.pag-1),text:"Atrás"})):(0,r.kq)("",!0),n.pag<a.getLastPage()?((0,r.wg)(),(0,r.j4)(u,{key:1,onDoClick:t[1]||(t[1]=e=>n.pag=n.pag+1),text:"Delante"})):(0,r.kq)("",!0)])}var oe=s(1337),re=s(505);const ne={class:"single-post__header"},ae={class:"text-semibold"},ie={class:"text-s"},le={class:"single-post__content"};function ue(e,t,s,o,n,a){const i=(0,r.up)("custom-button");return n.isShow?((0,r.wg)(),(0,r.iD)("article",{key:0,class:(0,m.C_)(["single-post",{mine:s.isMyPost}])},[(0,r._)("header",ne,[(0,r._)("p",ae,(0,m.zw)(s.userName),1),(0,r._)("p",ie,(0,m.zw)(s.date),1)]),(0,r._)("p",le,(0,m.zw)(s.message),1),s.isMyPost?((0,r.wg)(),(0,r.j4)(i,{key:0,text:"Borrar",onDoClick:a.borrarMensaje},null,8,["onDoClick"])):(0,r.kq)("",!0)],2)):(0,r.kq)("",!0)}var ce={name:"SinglePost",components:{CustomButton:f},mixins:[_],props:{userName:String,date:String,message:String,isMyPost:Boolean,id:Number},data(){return{isShow:!0}},methods:{borrarMensaje:async function(){this.isShow=!1;const{data:e,error:t}=await this.supabase.from("social_network-posts").delete().eq("id",this.id);return t&&alert(t),e}}};const me=(0,g.Z)(ce,[["render",ue]]);var de=me;function pe(e,t,s,o,n,a){const i=(0,r.up)("custom-textarea"),l=(0,r.up)("custom-button");return(0,r.wg)(),(0,r.iD)("form",null,[(0,r.Wm)(i,{label:"Tu mensaje",placeholder:"Escribe aquí",modelValue:n.mensaje,"onUpdate:modelValue":t[0]||(t[0]=e=>n.mensaje=e)},null,8,["modelValue"]),(0,r.Wm)(l,{onDoClick:a.enviar,type:"submit",text:"Enviar","button-disabled":a.disableSend},null,8,["onDoClick","button-disabled"])])}const he={class:"textarea"},ge={class:"textarea__label"},we=["placeholder","value"];function fe(e,t,s,o,n,a){return(0,r.wg)(),(0,r.iD)("div",he,[(0,r._)("label",ge,[(0,r.Uk)((0,m.zw)(s.label)+" ",1),(0,r._)("textarea",{class:"textarea__field",placeholder:s.placeholder,value:s.modelValue,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value))},null,40,we)])])}var be={name:"CustomTextarea",props:{label:String,placeholder:String,modelValue:String}};const _e=(0,g.Z)(be,[["render",fe]]);var ve=_e,ye={name:"CustomForm",components:{"custom-textarea":ve,"custom-button":f},mixins:[_],props:{userId:String},data(){return{mensaje:""}},computed:{disableSend:function(){return 0===this.mensaje.length}},methods:{enviar:async function(){const{error:e}=await this.supabase.from("social_network-posts").insert([{text:this.mensaje,user_id:this.userId}]);e?alert(e.message):(alert("Mensaje enviado!"),this.mensaje=""),console.log(this.userId)}},mounted(){}};const ke=(0,g.Z)(ye,[["render",pe]]);var Ce=ke,De={name:"HomeView",mixins:[_,v],components:{"custom-form":Ce,SinglePost:de,CustomButton:f},data(){return{myId:"",userName:"",profiles:[],posts:[],numMessagePage:5,pag:1,countMessage:0}},methods:{getFormatDate:function(){return(0,oe.Z)(new Date,new Date,{locale:re.Z})},mostrarMensajes:async function(){const e=(this.pag-1)*this.numMessagePage,t=e+this.numMessagePage-1,{data:s,error:o}=await this.supabase.from("social_network-posts").select("*").order("created_at",{ascending:!1}).range(e,t);this.getCountMessages(),o?alert(o.message):this.posts=s.reverse()},getCountMessages:async function(){const{data:e,error:t}=await this.supabase.from("social_network-posts").select("*");t?alert(t.message):this.countMessage=e.length},getLastPage:function(){return Math.ceil(this.countMessage/this.numMessagePage)},refrescoAutomaticoMensajes:function(){this.supabase.from("social_network-posts").on("*",(()=>{this.mostrarMensajes()})).subscribe()},getUsers:async function(){const{data:e,error:t}=await this.supabase.from("social_network-profile").select("name, user_id");t?alert(t.message):this.profiles=e},getUserName:function(e){return this.profiles.filter((t=>t.user_id==e))[0]?.name},isMyPost:function(e){return this.myId===e}},watch:{pag:function(){this.mostrarMensajes()}},async mounted(){this.myId=await this.supabase.auth.user().id,this.mostrarMensajes(),this.getUsers(),this.refrescoAutomaticoMensajes()}};const Ee=(0,g.Z)(De,[["render",se]]);var xe=Ee;const Ve=(0,r._)("div",null,null,-1),Ie={class:"search"},je=(0,r._)("h1",null,"Buscador",-1),Me={class:"search__form"},Ue={class:"search__posts"};function Se(e,t,s,o,n,a){const i=(0,r.up)("CustomInput"),l=(0,r.up)("custom-button"),u=(0,r.up)("single-post");return(0,r.wg)(),(0,r.iD)(r.HY,null,[Ve,(0,r._)("div",Ie,[je,(0,r._)("form",Me,[(0,r.Wm)(i,{label:"Buscador",type:"search",placeholder:"Escribe aquí",modelValue:n.search,"onUpdate:modelValue":t[0]||(t[0]=e=>n.search=e)},null,8,["modelValue"]),(0,r.Wm)(l,{onDoClick:a.buscar,text:"Buscar"},null,8,["onDoClick"])]),(0,r._)("div",Ue,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.posts,((e,t)=>((0,r.wg)(),(0,r.j4)(u,{key:t,message:e.text,userName:e.user_id,id:e.id},null,8,["message","userName","id"])))),128))])])],64)}var Le={name:"SearchView",components:{CustomButton:f,CustomInput:W,singlePost:de},mixins:[_],data(){return{search:"",posts:[]}},methods:{buscar:async function(){const{data:e}=await this.supabase.from("social_network-posts").select("text").ilike("text",`%${this.search}%`);this.posts=e},getFormatDate:function(){return(0,oe.Z)(new Date,new Date,{locale:re.Z})},getUserName:function(e){return this.profiles.filter((t=>t.user_id==e))[0]?.name}}};const Be=(0,g.Z)(Le,[["render",Se]]);var Ne=Be;const Ze=[{path:"/",name:"login",component:q},{path:"/registro",name:"signup",component:G},{path:"/home",name:"home",component:xe},{path:"/search",name:"search",component:Ne}],ze=(0,D.p7)({history:(0,D.r5)(),routes:Ze});var We=ze,Oe=s(9749),Pe=(0,Oe.MT)({state:{isLogin:!1},getters:{},mutations:{},actions:{},modules:{}}),$e=s(5431);(0,$e.z)("/whatsup/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}}),(0,o.ri)(C).use(Pe).use(We).mount("#app")}},t={};function s(o){var r=t[o];if(void 0!==r)return r.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,s),n.exports}s.m=e,function(){var e=[];s.O=function(t,o,r,n){if(!o){var a=1/0;for(c=0;c<e.length;c++){o=e[c][0],r=e[c][1],n=e[c][2];for(var i=!0,l=0;l<o.length;l++)(!1&n||a>=n)&&Object.keys(s.O).every((function(e){return s.O[e](o[l])}))?o.splice(l--,1):(i=!1,n<a&&(a=n));if(i){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[o,r,n]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,n,a=o[0],i=o[1],l=o[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(r in i)s.o(i,r)&&(s.m[r]=i[r]);if(l)var c=l(s)}for(t&&t(o);u<a.length;u++)n=a[u],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(c)},o=self["webpackChunkwhatsup"]=self["webpackChunkwhatsup"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[998],(function(){return s(4988)}));o=s.O(o)})();
//# sourceMappingURL=app.23fe608a.js.map